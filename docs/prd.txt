<context>
# Overview
Hospital Management System l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω b·ªánh vi·ªán to√†n di·ªán ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ s·ªë h√≥a v√† t·ªëi ∆∞u h√≥a c√°c quy tr√¨nh ho·∫°t ƒë·ªông c·ªßa b·ªánh vi·ªán t·∫°i Vi·ªát Nam. H·ªá th·ªëng gi·∫£i quy·∫øt c√°c v·∫•n ƒë·ªÅ v·ªÅ qu·∫£n l√Ω th√¥ng tin b·ªánh nh√¢n, l·ªãch h·∫πn kh√°m, h·ªì s∆° b√°c sƒ©, v√† c√°c quy tr√¨nh ƒëi·ªÅu tr·ªã m·ªôt c√°ch hi·ªáu qu·∫£ v√† an to√†n.

H·ªá th·ªëng ph·ª•c v·ª• 4 nh√≥m ng∆∞·ªùi d√πng ch√≠nh:
- **B·ªánh nh√¢n**: ƒê·∫∑t l·ªãch h·∫πn, xem h·ªì s∆° y t·∫ø, theo d√µi ƒëi·ªÅu tr·ªã
- **B√°c sƒ©**: Qu·∫£n l√Ω l·ªãch l√†m vi·ªác, h·ªì s∆° b·ªánh nh√¢n, k√™ ƒë∆°n thu·ªëc
- **Qu·∫£n tr·ªã vi√™n**: Qu·∫£n l√Ω to√†n b·ªô h·ªá th·ªëng, b√°o c√°o, ph√¢n quy·ªÅn
- **L·ªÖ t√¢n**: Check-in b·ªánh nh√¢n, qu·∫£n l√Ω h√†ng ƒë·ª£i, h·ªó tr·ª£ thanh to√°n

# üöÄ Key Innovations & Technical Achievements

## üÜî Department-Based ID System (IMPLEMENTED)
- **Smart ID Generation**: T·ª± ƒë·ªông t·∫°o ID c√≥ √Ω nghƒ©a business logic
- **Format**: `{DEPT_CODE}-{ENTITY}-{YYYYMM}-{SEQ}`
  - VD: `CARD-DOC-202412-001` (B√°c sƒ© tim m·∫°ch th·ª© 1 th√°ng 12/2024)
  - VD: `PAT-202412-001` (B·ªánh nh√¢n th·ª© 1 th√°ng 12/2024)
- **Auto-triggers**: Database triggers t·ª± ƒë·ªông generate ID khi INSERT
- **Business Logic**: ID ph·∫£n √°nh department, entity type v√† th·ªùi gian t·∫°o
- **Implementation**: PostgreSQL functions + triggers + sample data

## üîê Enhanced Authentication Architecture (IMPLEMENTED)
- **Unified Auth System**: T√≠ch h·ª£p Supabase Auth v·ªõi custom profiles
- **Multi-service Integration**: Auth Service (Node.js) + Frontend Auth hooks
- **Role-based Registration**: T·ª± ƒë·ªông t·∫°o role-specific records v·ªõi department-based IDs
- **Session Management**: JWT tokens v·ªõi refresh mechanism
- **Security Features**: Email verification, password reset, 2FA ready
- **Implementation**: Auth Service + Enhanced Auth hooks + Unified Auth Context

## üèóÔ∏è Microservices Architecture (PARTIALLY IMPLEMENTED)
- **Docker Containerization**: Full containerized development environment
- **Service Structure**: Auth Service (completed), Patient/Doctor/Appointment (planned)
- **API Gateway**: Centralized routing v√† rate limiting (in development)
- **Service Discovery**: Auto-discovery v√† health checks (planned)
- **Independent Deployment**: Each service c√≥ th·ªÉ deploy ƒë·ªôc l·∫≠p

## üé® Universal UI Components (IMPLEMENTED)
- **Universal Sidebar**: Reusable sidebar component cho t·∫•t c·∫£ roles
- **Role-based Navigation**: Dynamic menu theo user role v·ªõi badge support
- **Responsive Design**: Mobile-first approach v·ªõi overlay mobile menu
- **Consistent Branding**: Unified design system v·ªõi customizable branding
- **Layout System**: AdminLayout, DoctorLayout, PatientLayout components
- **Migration Guide**: Complete migration t·ª´ legacy components

## üìä Progress Tracking System (IMPLEMENTED)
- **Real-time Dashboard**: Live progress monitoring v·ªõi automated reporting
- **Phase-based Development**: 15 phases v·ªõi clear milestones v√† dependencies
- **Task Management**: Integrated task tracking v·ªõi weekly reports
- **Documentation Structure**: Comprehensive docs organization
- **Implementation**: Progress dashboard + weekly reports + task tracker

# Core Features - Targeting 10/10 Score

## üè• CH·ª®C NƒÇNG C∆† B·∫¢N (B·∫ÆT BU·ªòC - 6-7 ƒêI·ªÇM)

### 1. Qu·∫£n l√Ω ng∆∞·ªùi d√πng
- ƒêƒÉng k√Ω/ƒëƒÉng nh·∫≠p (b·ªánh nh√¢n, b√°c sƒ©, admin, l·ªÖ t√¢n)
- Ph√¢n quy·ªÅn theo vai tr√≤ (RBAC) v·ªõi fine-grained permissions
- Qu·∫£n l√Ω th√¥ng tin c√° nh√¢n v·ªõi validation
- ƒê·ªïi m·∫≠t kh·∫©u, qu√™n m·∫≠t kh·∫©u v·ªõi secure flows
- X√°c th·ª±c 2 l·ªõp (2FA) v·ªõi OTP qua email/SMS

### 2. Qu·∫£n l√Ω b·ªánh nh√¢n
- ƒêƒÉng k√Ω b·ªánh nh√¢n m·ªõi v·ªõi department-based ID
- L∆∞u tr·ªØ th√¥ng tin: c√° nh√¢n, ti·ªÅn s·ª≠ b·ªánh, d·ªã ·ª©ng
- T√¨m ki·∫øm, l·ªçc b·ªánh nh√¢n v·ªõi advanced filters
- C·∫≠p nh·∫≠t h·ªì s∆° b·ªánh √°n v·ªõi audit trail
- Qu·∫£n l√Ω th·∫ª BHYT v·ªõi validation

### 3. Qu·∫£n l√Ω b√°c sƒ©
- H·ªì s∆° b√°c sƒ©: chuy√™n khoa, kinh nghi·ªám, h·ªçc v·∫•n, license
- L·ªãch l√†m vi·ªác c·ªßa b√°c sƒ© v·ªõi conflict detection
- ƒê√°nh gi√° v√† nh·∫≠n x√©t t·ª´ b·ªánh nh√¢n v·ªõi rating system
- Qu·∫£n l√Ω ca tr·ª±c v·ªõi automatic scheduling

### 4. Qu·∫£n l√Ω l·ªãch h·∫πn
- ƒê·∫∑t l·ªãch kh√°m (online/offline) v·ªõi real-time availability
- Xem l·ªãch theo ng√†y/tu·∫ßn/th√°ng v·ªõi calendar view
- H·ªßy/thay ƒë·ªïi l·ªãch h·∫πn v·ªõi notification system
- Nh·∫Øc nh·ªü l·ªãch h·∫πn (email/SMS) automated
- Qu·∫£n l√Ω danh s√°ch ch·ªù v·ªõi priority queue

### 5. Qu·∫£n l√Ω ph√≤ng ban
- Danh s√°ch ph√≤ng kh√°m theo chuy√™n khoa
- Tr·∫°ng th√°i ph√≤ng (tr·ªëng/b·∫≠n/b·∫£o tr√¨) real-time
- L·ªãch s·ª≠ s·ª≠ d·ª•ng ph√≤ng v·ªõi analytics
- ƒê·∫∑t ph√≤ng cho cu·ªôc h·∫πn v·ªõi conflict resolution

## ü§ñ CH·ª®C NƒÇNG AI C∆† B·∫¢N (7-8 ƒêI·ªÇM)

### 6. Chatbot h·ªó tr·ª£
- Tr·∫£ l·ªùi c√¢u h·ªèi th∆∞·ªùng g·∫∑p v·ªÅ b·ªánh vi·ªán v·ªõi NLP
- H∆∞·ªõng d·∫´n ƒë·∫∑t l·ªãch kh√°m interactive
- T∆∞ v·∫•n s∆° b·ªô tri·ªáu ch·ª©ng v·ªõi medical knowledge base
- H·ªó tr·ª£ ƒëa ng√¥n ng·ªØ (Vi·ªát/Anh) v·ªõi translation

### 7. Ph√¢n t√≠ch tri·ªáu ch·ª©ng th√¥ng minh
- Nh·∫≠p tri·ªáu ch·ª©ng ‚Üí g·ª£i √Ω khoa kh√°m v·ªõi ML model
- ƒê√°nh gi√° m·ª©c ƒë·ªô kh·∫©n c·∫•p v·ªõi triage algorithm
- G·ª£i √Ω b√°c sƒ© ph√π h·ª£p based on specialization
- ∆Ø·ªõc t√≠nh th·ªùi gian ch·ªù v·ªõi predictive analytics

### 8. G·ª£i √Ω th√¥ng minh
- G·ª£i √Ω th·ªùi gian kh√°m √≠t ƒë√¥ng ƒë√∫c v·ªõi pattern analysis
- ƒê·ªÅ xu·∫•t g√≥i kh√°m s·ª©c kh·ªèe personalized
- Nh·∫Øc nh·ªü t√°i kh√°m ƒë·ªãnh k·ª≥ v·ªõi health tracking

## üí≥ CH·ª®C NƒÇNG THANH TO√ÅN C∆† B·∫¢N (7-8 ƒêI·ªÇM)

### 9. H·ªá th·ªëng thanh to√°n
- T√≠ch h·ª£p VNPay, MoMo, ZaloPay v·ªõi secure API
- Thanh to√°n qua QR code v·ªõi dynamic generation
- Thanh to√°n th·∫ª t√≠n d·ª•ng/ghi n·ª£ v·ªõi PCI compliance
- Thanh to√°n ti·ªÅn m·∫∑t (ghi nh·∫≠n) v·ªõi receipt system

### 10. Qu·∫£n l√Ω h√≥a ƒë∆°n
- T·ª± ƒë·ªông t·∫°o h√≥a ƒë∆°n sau kh√°m v·ªõi itemization
- L·ªãch s·ª≠ thanh to√°n v·ªõi detailed tracking
- Xu·∫•t h√≥a ƒë∆°n PDF v·ªõi professional template
- Nh·∫Øc nh·ªü thanh to√°n v·ªõi automated reminders

### 11. X·ª≠ l√Ω b·∫£o hi·ªÉm y t·∫ø
- Ki·ªÉm tra th·∫ª BHYT v·ªõi government API integration
- T√≠nh to√°n ph·∫ßn b·∫£o hi·ªÉm chi tr·∫£ automatically
- T·ª± ƒë·ªông l√†m gi·∫•y ra vi·ªán v·ªõi digital signature

# User Experience  
## User Personas:
1. **B·ªánh nh√¢n (25-65 tu·ªïi)**: C·∫ßn ƒë·∫∑t l·ªãch kh√°m d·ªÖ d√†ng, xem th√¥ng tin y t·∫ø
2. **B√°c sƒ© (30-60 tu·ªïi)**: C·∫ßn qu·∫£n l√Ω l·ªãch l√†m vi·ªác, h·ªì s∆° b·ªánh nh√¢n hi·ªáu qu·∫£
3. **Admin (25-45 tu·ªïi)**: C·∫ßn gi√°m s√°t to√†n b·ªô h·ªá th·ªëng, b√°o c√°o th·ªëng k√™

## Key User Flows:
- **B·ªánh nh√¢n**: ƒêƒÉng k√Ω ‚Üí X√°c th·ª±c email ‚Üí ƒê·∫∑t l·ªãch h·∫πn ‚Üí Kh√°m b·ªánh ‚Üí Xem k·∫øt qu·∫£ ‚Üí Thanh to√°n
- **B√°c sƒ©**: ƒêƒÉng nh·∫≠p ‚Üí Xem l·ªãch h·∫πn ‚Üí Kh√°m b·ªánh ‚Üí K√™ ƒë∆°n ‚Üí C·∫≠p nh·∫≠t h·ªì s∆° ‚Üí Analytics
- **Admin**: ƒêƒÉng nh·∫≠p ‚Üí Dashboard ‚Üí Qu·∫£n l√Ω users ‚Üí Xem b√°o c√°o ‚Üí C·∫•u h√¨nh h·ªá th·ªëng ‚Üí Monitor
- **L·ªÖ t√¢n**: ƒêƒÉng nh·∫≠p ‚Üí Check-in b·ªánh nh√¢n ‚Üí Qu·∫£n l√Ω h√†ng ƒë·ª£i ‚Üí H·ªó tr·ª£ thanh to√°n

## üöÄ CH·ª®C NƒÇNG N√ÇNG CAO (8-9 ƒêI·ªÇM)

### 12. AI n√¢ng cao
- **M√¥ h√¨nh h·ªçc m√°y t√πy ch·ªânh**: D·ª± ƒëo√°n t√°i kh√°m v·ªõi patient history analysis
- **X·ª≠ l√Ω ng√¥n ng·ªØ t·ª± nhi√™n**: Ph√¢n t√≠ch b√°o c√°o y t·∫ø v·ªõi medical NER
- **Computer Vision**: Scan th·∫ª BHYT, gi·∫•y t·ªù v·ªõi OCR technology
- **Ph√¢n t√≠ch xu h∆∞·ªõng b·ªánh**: Dashboard cho admin v·ªõi epidemic tracking
- **AI gi·∫£i th√≠ch ƒë∆∞·ª£c**: L√Ω do ƒë∆∞a ra g·ª£i √Ω v·ªõi explainable AI

### 13. Thanh to√°n th√¥ng minh
- **Ph√°t hi·ªán gian l·∫≠n**: AI detect suspicious transactions v·ªõi anomaly detection
- **ƒê·ªãnh gi√° ƒë·ªông**: Gi√° kh√°m theo nhu c·∫ßu v·ªõi demand-based pricing
- **Ph√¢n t√≠ch chi ti√™u**: Insight cho b·ªánh nh√¢n v·ªõi spending patterns
- **Thanh to√°n tr·∫£ g√≥p**: AI ƒë√°nh gi√° kh·∫£ nƒÉng tr·∫£ v·ªõi credit scoring
- **Multi-currency**: H·ªó tr·ª£ nhi·ªÅu ti·ªÅn t·ªá v·ªõi real-time exchange rates

### 14. T√≠nh nƒÉng th·ªùi gian th·ª±c
- **WebSocket**: Th√¥ng b√°o real-time v·ªõi instant updates
- **Live chat**: T∆∞ v·∫•n tr·ª±c tuy·∫øn v·ªõi b√°c sƒ© v·ªõi video/audio support
- **C·∫≠p nh·∫≠t tr·∫°ng th√°i**: Live tracking l·ªãch kh√°m v·ªõi GPS integration
- **Dashboard real-time**: Gi√°m s√°t h·ªá th·ªëng v·ªõi live metrics

### 15. B√°o c√°o v√† ph√¢n t√≠ch
- **Dashboard qu·∫£n l√Ω**: KPIs b·ªánh vi·ªán v·ªõi interactive charts
- **B√°o c√°o doanh thu**: Theo ng√†y/th√°ng/nƒÉm v·ªõi trend analysis
- **Ph√¢n t√≠ch b·ªánh nh√¢n**: Demographics, patterns v·ªõi cohort analysis
- **Hi·ªáu su·∫•t b√°c sƒ©**: ƒê√°nh gi√° nƒÉng su·∫•t v·ªõi performance metrics
- **D·ª± ƒëo√°n xu h∆∞·ªõng**: Forecasting v·ªõi ML models

## üõ°Ô∏è CH·ª®C NƒÇNG B·∫¢O M·∫¨T & HI·ªÜU SU·∫§T (9-10 ƒêI·ªÇM)

### 16. B·∫£o m·∫≠t n√¢ng cao
- **M√£ h√≥a d·ªØ li·ªáu**: End-to-end encryption v·ªõi AES-256
- **Audit logs**: Theo d√µi m·ªçi h√†nh ƒë·ªông v·ªõi immutable logging
- **HIPAA compliance**: Tu√¢n th·ªß quy ƒë·ªãnh y t·∫ø v·ªõi data governance
- **Penetration testing**: Ki·ªÉm tra l·ªó h·ªïng v·ªõi automated security scans
- **Data masking**: ·∫®n th√¥ng tin nh·∫°y c·∫£m v·ªõi dynamic masking

### 17. T·ªëi ∆∞u hi·ªáu su·∫•t
- **Caching**: Redis cho data th∆∞·ªùng d√πng v·ªõi intelligent cache invalidation
- **Database optimization**: Indexing, query tuning v·ªõi performance monitoring
- **CDN**: TƒÉng t·ªëc t·∫£i trang v·ªõi global edge locations
- **Load balancing**: Ph√¢n t·∫£i traffic v·ªõi auto-scaling
- **API rate limiting**: Ch·ªëng DDoS v·ªõi adaptive throttling

### 18. Gi√°m s√°t v√† logging
- **Health monitoring**: Uptime tracking v·ªõi SLA monitoring
- **Performance metrics**: Response time, throughput v·ªõi APM tools
- **Error tracking**: Log l·ªói chi ti·∫øt v·ªõi stack trace analysis
- **User analytics**: Behavior tracking v·ªõi privacy compliance
- **Alert system**: C·∫£nh b√°o khi c√≥ v·∫•n ƒë·ªÅ v·ªõi intelligent alerting

## üì± CH·ª®C NƒÇNG TR·∫¢I NGHI·ªÜM NG∆Ø·ªúI D√ôNG (9-10 ƒêI·ªÇM)

### 19. Giao di·ªán hi·ªán ƒë·∫°i
- **Responsive design**: Ho·∫°t ƒë·ªông t·ªët m·ªçi thi·∫øt b·ªã v·ªõi mobile-first approach
- **Progressive Web App (PWA)**: C√†i ƒë·∫∑t nh∆∞ app native v·ªõi offline capabilities
- **Dark/Light mode**: Ch·∫ø ƒë·ªô s√°ng/t·ªëi v·ªõi user preference persistence
- **Accessibility**: H·ªó tr·ª£ ng∆∞·ªùi khuy·∫øt t·∫≠t v·ªõi WCAG 2.1 compliance
- **Multi-language**: ƒêa ng√¥n ng·ªØ v·ªõi i18n framework

### 20. T√≠nh nƒÉng mobile
- **Push notifications**: Th√¥ng b√°o ƒë·∫©y v·ªõi personalized content
- **Biometric login**: V√¢n tay, khu√¥n m·∫∑t v·ªõi secure biometric storage
- **Offline capabilities**: Ho·∫°t ƒë·ªông offline m·ªôt ph·∫ßn v·ªõi data synchronization
- **Camera integration**: Ch·ª•p ·∫£nh t√†i li·ªáu v·ªõi document scanning
- **GPS integration**: T√¨m ƒë∆∞·ªùng ƒë·∫øn b·ªánh vi·ªán v·ªõi navigation

## üîß CH·ª®C NƒÇNG K·ª∏ THU·∫¨T (10 ƒêI·ªÇM)

### 21. Ki·∫øn tr√∫c microservices
- **API Gateway**: Qu·∫£n l√Ω t·∫•t c·∫£ API calls v·ªõi rate limiting v√† authentication
- **Service discovery**: T·ª± ƒë·ªông t√¨m services v·ªõi health checks
- **Circuit breaker**: X·ª≠ l√Ω service failure v·ªõi graceful degradation
- **Message queues**: X·ª≠ l√Ω b·∫•t ƒë·ªìng b·ªô v·ªõi event-driven architecture
- **Container orchestration**: Docker + Kubernetes v·ªõi auto-scaling

### 22. DevOps v√† CI/CD
- **Automated testing**: Unit, integration, E2E tests v·ªõi high coverage
- **Continuous deployment**: Auto deploy khi merge code v·ªõi blue-green deployment
- **Infrastructure as Code**: Terraform/CloudFormation v·ªõi version control
- **Monitoring stack**: Prometheus + Grafana v·ªõi custom dashboards
- **Backup strategies**: Automated backup & recovery v·ªõi disaster recovery

### 23. T√≠ch h·ª£p b√™n ngo√†i
- **APIs b√™n th·ª© 3**: Google Calendar, Maps v·ªõi OAuth integration
- **Email service**: SendGrid cho email automation v·ªõi templates
- **SMS gateway**: G·ª≠i SMS th√¥ng b√°o v·ªõi delivery tracking
- **Cloud storage**: AWS S3 cho file storage v·ªõi CDN integration
- **Analytics**: Google Analytics integration v·ªõi privacy compliance
</context>

<PRD>
# Technical Architecture

## üèóÔ∏è Current Implementation Status:
‚úÖ **Completed Infrastructure:**
- Docker containerization v·ªõi docker-compose setup
- Supabase database v·ªõi complete department-based ID system
- Auth Service v·ªõi enhanced authentication flows
- Universal Sidebar components v·ªõi role-based navigation
- Progress tracking system v·ªõi automated reporting
- Comprehensive documentation structure

üöß **In Development:**
- API Gateway implementation v·ªõi routing v√† rate limiting
- Core microservices (Patient, Doctor, Appointment services)
- Frontend-backend integration testing
- Database performance optimization

üìã **Planned:**
- Kubernetes orchestration
- Monitoring stack (Prometheus + Grafana)
- CI/CD pipeline v·ªõi automated testing
- Advanced security features

## System Components:
- **Frontend**: Next.js v·ªõi TypeScript, Tailwind CSS, Universal UI Components
- **Backend**: Microservices v·ªõi Node.js/Express, Docker containerization
- **Database**: Supabase (PostgreSQL) v·ªõi Row Level Security, Department-based IDs
- **Authentication**: Supabase Auth + Auth Service v·ªõi custom profiles v√† JWT
- **API Gateway**: Centralized routing, rate limiting, service discovery (in development)
- **Containerization**: Docker v·ªõi docker-compose, Kubernetes (planned)
- **Testing**: Jest + Cypress v·ªõi automated testing pipeline (planned)
- **Monitoring**: Prometheus + Grafana v·ªõi custom dashboards (planned)

## Microservices Architecture:
1. **Auth Service** ‚úÖ: X√°c th·ª±c, ph√¢n quy·ªÅn, qu·∫£n l√Ω session, department-based registration
2. **Patient Service** üöß: CRUD b·ªánh nh√¢n, h·ªì s∆° y t·∫ø, BHYT integration
3. **Doctor Service** üöß: CRUD b√°c sƒ©, l·ªãch l√†m vi·ªác, chuy√™n khoa, rating system
4. **Appointment Service** üöß: ƒê·∫∑t l·ªãch, qu·∫£n l√Ω l·ªãch h·∫πn, conflict resolution
5. **Department Service** üìã: Qu·∫£n l√Ω khoa/ph√≤ng ban, specialty management
6. **Notification Service** üìã: Email, SMS notifications, real-time alerts

## Enhanced Data Models v·ªõi Department-Based IDs:
- **Users**: id (UUID), email, role, created_at, is_active
- **Profiles**: user_id, full_name, phone, date_of_birth, address, gender
- **Departments**: dept_id, name, description, dept_code (CARD, NEUR, etc.)
- **Specialties**: specialty_id, name, department_id, description
- **Doctors**: doctor_id (CARD-DOC-202412-001), user_id, license_number, specialty_id
- **Patients**: patient_id (PAT-202412-001), user_id, bhyt_number, medical_history
- **Appointments**: appointment_id (CARD-APP-202412-001), doctor_id, patient_id, datetime, status
- **Medical_Records**: record_id (CARD-MR-202412-001), patient_id, doctor_id, diagnosis

# Development Roadmap - 10/10 Score Target
## Phase 1: Infrastructure & Database Foundation (Weeks 1-3)
- Setup Docker containerization v·ªõi microservices architecture
- Implement complete Supabase database structure v·ªõi department-based ID system
- Setup API Gateway v·ªõi routing, rate limiting, v√† authentication
- Configure development environment v√† CI/CD pipeline v·ªõi automated testing
- Implement database migrations, seed data, v√† backup strategies
- Setup monitoring stack (Prometheus + Grafana) v√† logging system

## Phase 2: Authentication & Authorization System (Weeks 4-6)
- Complete Auth Service v·ªõi Supabase integration v√† RBAC
- Implement email verification, password reset flows v·ªõi secure tokens
- Setup JWT token management, session handling v·ªõi refresh tokens
- Implement 2FA v·ªõi OTP (email/SMS) v√† biometric login
- Create fine-grained permissions system v·ªõi audit logging
- Basic frontend layout v·ªõi Universal Sidebar v√† responsive design

## Phase 3: Core User Management (Weeks 7-10)
- Patient Service: Registration, profile management, medical history v·ªõi BHYT integration
- Doctor Service: Registration, profile, specialties, license validation v·ªõi rating system
- Admin Service: User management, system configuration v·ªõi advanced permissions
- Receptionist Service: Check-in, queue management, payment support
- Profile pages cho t·∫•t c·∫£ user roles v·ªõi accessibility compliance
- Implement advanced user search, filtering v·ªõi analytics tracking

## Phase 4: Department & Room Management (Weeks 11-13)
- Department Service: CRUD operations cho khoa/ph√≤ng ban v·ªõi hierarchy
- Specialty management v·ªõi dynamic data loading v√† AI-powered matching
- Doctor-Department assignment system v·ªõi workload balancing
- Room v√† bed management v·ªõi real-time status tracking
- Equipment tracking system v·ªõi maintenance scheduling

## Phase 5: Appointment Booking System (Weeks 14-17)
- Core appointment booking v·ªõi intelligent time slot management
- Doctor schedule management v·ªõi availability tracking v√† conflict detection
- Appointment status workflow v·ªõi automated notifications
- AI-powered appointment suggestions based on symptoms
- Waiting list management v·ªõi priority queue v√† predictive analytics
- Real-time updates v·ªõi WebSocket integration

## Phase 6: Payment & Insurance System (Weeks 18-21)
- Multi-payment gateway integration (VNPay, MoMo, ZaloPay)
- QR code payment v·ªõi dynamic generation
- BHYT integration v·ªõi government API
- Automated invoice generation v·ªõi PDF export
- Fraud detection v·ªõi AI-powered anomaly detection
- Payment analytics v√† reporting

## Phase 7: AI & Chatbot System (Weeks 22-25)
- Intelligent chatbot v·ªõi NLP v√† medical knowledge base
- Symptom analysis v·ªõi ML-powered triage system
- Smart recommendations cho appointment timing
- Predictive analytics cho patient flow
- Computer Vision cho document scanning (BHYT, ID cards)
- Explainable AI v·ªõi reasoning transparency

## Phase 8: Medical Records & Clinical Features (Weeks 26-29)
- Electronic Medical Records (EMR) system v·ªõi audit trail
- Prescription management v·ªõi drug interaction checking
- Diagnosis tracking v·ªõi ICD-10 codes v√† medical coding
- Lab results integration v·ªõi third-party systems
- Medical imaging upload, viewing v·ªõi DICOM support
- Clinical decision support v·ªõi evidence-based recommendations

## Phase 9: Real-time Features & Communication (Weeks 30-33)
- WebSocket implementation cho real-time updates
- Live chat system v·ªõi video/audio consultation
- Push notifications v·ªõi personalized content
- Emergency alert system v·ªõi escalation protocols
- Real-time dashboard v·ªõi live metrics
- GPS integration cho navigation v√† location services

## Phase 10: Advanced Analytics & Reporting (Weeks 34-37)
- Comprehensive admin dashboard v·ªõi interactive KPIs
- Patient flow analytics v·ªõi predictive modeling
- Doctor performance metrics v·ªõi benchmarking
- Financial reporting v·ªõi trend analysis v√† forecasting
- Custom report builder v·ªõi drag-and-drop interface
- Business intelligence v·ªõi data visualization

## Phase 11: Mobile & PWA Features (Weeks 38-41)
- Progressive Web App (PWA) implementation
- Mobile-first responsive design v·ªõi touch optimization
- Biometric authentication (fingerprint, face recognition)
- Offline capabilities v·ªõi data synchronization
- Camera integration cho document scanning
- Push notifications v·ªõi rich media support

## Phase 12: Security & Performance Optimization (Weeks 42-45)
- End-to-end encryption implementation
- HIPAA compliance audit v√† certification
- Penetration testing v·ªõi vulnerability assessment
- Performance optimization v·ªõi caching strategies
- Load balancing v·ªõi auto-scaling
- Database optimization v·ªõi advanced indexing

## Phase 13: DevOps & Infrastructure (Weeks 46-49)
- Kubernetes orchestration v·ªõi container management
- CI/CD pipeline v·ªõi automated testing v√† deployment
- Infrastructure as Code v·ªõi Terraform
- Monitoring stack v·ªõi alerting system
- Backup strategies v·ªõi disaster recovery testing
- Blue-green deployment v·ªõi rollback capabilities

## Phase 14: Third-party Integrations (Weeks 50-53)
- Government API integration (BHYT, citizen database)
- Google Services integration (Calendar, Maps, Analytics)
- Email service integration (SendGrid) v·ªõi automation
- SMS gateway integration v·ªõi delivery tracking
- Cloud storage integration (AWS S3) v·ªõi CDN
- External lab v√† pharmacy system integration

## Phase 15: Final Testing & Launch (Weeks 54-56)
- Comprehensive end-to-end testing v·ªõi user acceptance testing
- Performance testing v·ªõi load simulation
- Security testing v·ªõi final penetration testing
- User training v√† documentation creation
- Production deployment v·ªõi monitoring
- Post-launch support v√† maintenance planning

# Logical Dependency Chain
## Foundation Layer (Must be completed first):
1. **Infrastructure Setup**: Docker, API Gateway, CI/CD pipeline
2. **Database Foundation**: Complete schema v·ªõi department-based ID system
3. **Authentication Core**: Supabase Auth v·ªõi JWT v√† session management

## Core Services Layer (Can be developed in parallel):
4. **User Management Services**: Auth, Patient, Doctor, Admin services
5. **Department Management**: Khoa/ph√≤ng ban v·ªõi specialty assignment
6. **Basic UI Framework**: Universal Sidebar, layouts, routing

## Business Logic Layer (Depends on Core Services):
7. **Appointment System**: Booking, scheduling, conflict resolution
8. **Medical Records**: EMR, prescriptions, diagnosis tracking
9. **Notification System**: Email, SMS, in-app notifications

## Advanced Features Layer (Depends on Business Logic):
10. **Analytics & Reporting**: Dashboard, metrics, custom reports
11. **Integration Layer**: Payment, insurance, pharmacy, lab systems
12. **Advanced Clinical Features**: Telemedicine, imaging, lab results

## Quality Assurance Layer (Continuous throughout):
13. **Testing Framework**: Unit, integration, E2E testing
14. **Security Implementation**: Audit, penetration testing, compliance
15. **Performance Optimization**: Load testing, database tuning

## Deployment & Maintenance Layer (Final phase):
16. **Production Setup**: Environment, monitoring, backup systems
17. **Documentation & Training**: User guides, API docs, training materials
18. **Post-Launch Support**: Bug fixes, enhancements, maintenance

# Risks and Mitigations  
## Technical Challenges:
- **Database Performance**: Implement proper indexing v√† caching
- **Microservice Communication**: Use API Gateway v·ªõi proper error handling
- **Data Consistency**: Implement database transactions v√† validation

## MVP Strategy:
- Focus on core appointment booking functionality first
- Implement basic CRUD operations before advanced features
- Ensure each microservice works independently

## Resource Constraints:
- Prioritize features based on user impact
- Use existing libraries v√† frameworks where possible
- Implement comprehensive testing to reduce bugs

# Appendix  
## Vietnamese Compliance:
- Phone numbers: 10 digits starting with 0
- Doctor license format: VN-{2 letters}-{4 digits}
- Vietnamese-only interface
- Local date/time formats

## Security Requirements:
- Row Level Security trong Supabase
- JWT token authentication
- Input validation v√† sanitization
- HTTPS only communication

## Performance Targets (10/10 Score):
- **Page load time**: < 1.5 seconds (mobile), < 1 second (desktop)
- **API response time**: < 200ms (average), < 500ms (95th percentile)
- **Concurrent users**: Support 5000+ concurrent users v·ªõi auto-scaling
- **Uptime**: 99.95% availability v·ªõi SLA monitoring
- **Database performance**: < 100ms query response time
- **Real-time features**: < 50ms WebSocket latency
- **Mobile performance**: Lighthouse score > 90
- **Security**: Zero critical vulnerabilities, automated security scanning
- **Accessibility**: WCAG 2.1 AA compliance
- **SEO**: Core Web Vitals passing scores

## Success Metrics (KPIs):
- **User Adoption**: 80% monthly active users
- **Appointment Efficiency**: 30% reduction in booking time
- **Patient Satisfaction**: 4.5+ star rating
- **Doctor Productivity**: 25% increase in patient throughput
- **System Reliability**: < 0.1% error rate
- **Payment Success**: 99.5% transaction success rate
- **AI Accuracy**: 85%+ symptom-to-specialty matching accuracy
</PRD>
